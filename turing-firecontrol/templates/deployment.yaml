apiVersion: v1
items:
- apiVersion: v1
  data:
    cluster.name: turing-es
  kind: ConfigMap
  metadata:
    labels:
      cattle.io/creator: norman
    name: es-config
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-admin
    name: turing-admin
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-admin
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-admin
      spec:
        containers:
        - image: hub.iot.store/turing/turing-admin:V1.7.0-RELEASE
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 8762
            timeoutSeconds: 2
          name: turing-admin
          ports:
          - containerPort: 8762
            name: 8762tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 8762
            timeoutSeconds: 2
          resources:
            requests:
              memory: 1Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-auth
    name: turing-auth
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-auth
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-auth
      spec:
        containers:
        - image: hub.iot.store/turing/turing-auth:V1.7.0-RELEASE
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 100
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 9777
            timeoutSeconds: 2
          name: turing-auth
          ports:
          - containerPort: 9777
            name: 9777tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 100
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 9777
            timeoutSeconds: 2
          resources:
            requests:
              memory: 1Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-center
    name: turing-center
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-center
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-center
      spec:
        containers:
        - image: hub.iot.store/turing/turing-center:V1.7.0-RELEASE
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 20
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 8761
            timeoutSeconds: 2
          name: turing-center
          ports:
          - containerPort: 8761
            name: 8761tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 20
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 8761
            timeoutSeconds: 2
          resources:
            requests:
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsConfig: {}
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-config
    name: turing-config
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-config
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-config
      spec:
        containers:
        - image: hub.iot.store/turing/turing-config:V1.7.0-RELEASE
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 8750
            timeoutSeconds: 2
          name: turing-config
          ports:
          - containerPort: 8750
            name: 8750tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 8750
            timeoutSeconds: 2
          resources:
            requests:
              memory: 256Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-datahandler
    name: turing-datahandler
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-datahandler
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-datahandler
      spec:
        containers:
        - image: hub.iot.store/turing/turing-datahandler:V1.7.0-RELEASE
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 120
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 2345
            timeoutSeconds: 2
          name: turing-datahandler
          ports:
          - containerPort: 2345
            name: 2345tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 120
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 2345
            timeoutSeconds: 2
          resources:
            requests:
              memory: 2Gi
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-device
    name: turing-device
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-device
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-device
      spec:
        containers:
        - image: hub.iot.store/turing/turing-device:V1.7.0-RELEASE
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 120
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 2222
            timeoutSeconds: 2
          name: turing-device
          ports:
          - containerPort: 8765
            name: 8765tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 120
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 2222
            timeoutSeconds: 2
          resources:
            requests:
              memory: 2Gi
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-es
    name: turing-es
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-es
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-es
      spec:
        containers:
        - env:
          - name: ES_JAVA_OPTS
            value: -Xms2g -Xmx2g
          - name: cluster.name
            valueFrom:
              configMapKeyRef:
                key: cluster.name
                name: es-config
                optional: false
          image: elasticsearch:6.6.2
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 9300
            timeoutSeconds: 2
          name: turing-es
          ports:
          - containerPort: 9200
            name: 9200tcp02
            protocol: TCP
          - containerPort: 9300
            name: 9300tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 9300
            timeoutSeconds: 2
          resources:
            requests:
              memory: 1Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
          volumeMounts:
          - mountPath: /usr/share/elasticsearch/data
            name: es-data
        dnsPolicy: ClusterFirst
        nodeName: worker06
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - hostPath:
            path: /data/es
            type: DirectoryOrCreate
          name: es-data
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-gate
    name: turing-gate
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-gate
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-gate
      spec:
        containers:
        - image: hub.iot.store/turing/turing-gate:V1.7.0-RELEASE
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 8765
            timeoutSeconds: 2
          name: turing-gate
          ports:
          - containerPort: 8765
            name: 8765tcp2
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 8765
            timeoutSeconds: 2
          resources:
            requests:
              memory: 256Mi
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-mysql
    name: turing-mysql
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-mysql
    strategy:
      rollingUpdate:
        maxSurge: 0
        maxUnavailable: 1
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-mysql
      spec:
        containers:
        - env:
          - name: MYSQL_DATABASE
            value: turing_admin
          - name: MYSQL_PASSWORD
            value: turing2019
          - name: MYSQL_ROOT_PASSWORD
            value: turing2019
          - name: MYSQL_USER
            value: turing
          - name: TZ
            value: Asia/Shanghai
          image: hub.iot.store/turing/turing-mysql:V1.7.0-RELEASE
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 3306
            timeoutSeconds: 2
          name: turing-mysql
          ports:
          - containerPort: 3306
            name: 3306tcp01
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 30
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 3306
            timeoutSeconds: 2
          resources:
            requests:
              memory: 1Gi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
          volumeMounts:
          - mountPath: /var/lib/mysql
            name: mysql-data
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        nodeName: worker06
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - hostPath:
            path: /data/mysql
            type: DirectoryOrCreate
          name: mysql-data
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-rabbitmq
    name: turing-rabbitmq
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-rabbitmq
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-rabbitmq
      spec:
        containers:
        - env:
          - name: RABBITMQ_DEFAULT_PASS
            value: turing2019
          - name: RABBITMQ_DEFAULT_USER
            value: root
          image: rabbitmq:3.6.5-management
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 10
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 15672
            timeoutSeconds: 2
          name: turing-rabbitmq
          ports:
          - containerPort: 15672
            name: 15672tcp02
            protocol: TCP
          - containerPort: 15671
            name: 15671tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 10
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 15672
            timeoutSeconds: 2
          resources:
            requests:
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
          volumeMounts:
          - mountPath: /var/lib/rabbitmq
            name: rabbitmq-data
        dnsPolicy: ClusterFirst
        nodeName: worker04
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - hostPath:
            path: /data/rabbitmq
            type: DirectoryOrCreate
          name: rabbitmq-data
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-redis
    name: turing-redis
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-redis
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-redis
      spec:
        containers:
        - image: redis:4.0.14-alpine
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 10
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 6379
            timeoutSeconds: 2
          name: turing-redis
          ports:
          - containerPort: 6379
            name: 6379tcp02
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 10
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 6379
            timeoutSeconds: 2
          resources:
            requests:
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities: {}
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
- apiVersion: extensions/v1beta1
  kind: Deployment
  metadata:
    labels:
      cattle.io/creator: norman
      workload.user.cattle.io/workloadselector: deployment-turing-turing-web
    name: turing-web
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        workload.user.cattle.io/workloadselector: deployment-turing-turing-web
    strategy:
      rollingUpdate:
        maxSurge: 1
        maxUnavailable: 0
      type: RollingUpdate
    template:
      metadata:
        labels:
          workload.user.cattle.io/workloadselector: deployment-turing-turing-web
      spec:
        containers:
        - image: hub.iot.store/turing/turing-web:V1.7.0-RELEASE
          imagePullPolicy: IfNotPresent
          livenessProbe:
            failureThreshold: 3
            initialDelaySeconds: 10
            periodSeconds: 2
            successThreshold: 1
            tcpSocket:
              port: 80
            timeoutSeconds: 2
          name: turing-web
          ports:
          - containerPort: 80
            name: 80tcp2
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            initialDelaySeconds: 10
            periodSeconds: 2
            successThreshold: 2
            tcpSocket:
              port: 80
            timeoutSeconds: 2
          resources:
            requests:
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            privileged: false
            readOnlyRootFilesystem: false
            runAsNonRoot: false
          stdin: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          tty: true
        dnsPolicy: ClusterFirst
        imagePullSecrets:
        - name: hub-iot
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
kind: List
